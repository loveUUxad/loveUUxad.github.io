<!DOCTYPE html>
<html lang="zh-Hans">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="王霄" />



<meta name="description" content="1. mysql数据库 数据库是 “按照数据结构来组织、存储和管理数据的仓库”。是一个长期存储在计算机内的、有组织的、可共享的、统一管理的大量数据的集合 MySQL 是一款安全、跨平台、高效的，并与 PHP、Java 等主流编程语言紧密结合的数据库系统。该数据库系统是由瑞典的 MySQL AB 公司开发、发布并支持，由 MySQL 的初始开发人员 David Axmark 和 Michael Mo">
<meta property="og:type" content="article">
<meta property="og:title" content="mysql数据结构">
<meta property="og:url" content="http://example.com/2023/04/13/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/mysql%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/index.html">
<meta property="og:site_name" content="WX">
<meta property="og:description" content="1. mysql数据库 数据库是 “按照数据结构来组织、存储和管理数据的仓库”。是一个长期存储在计算机内的、有组织的、可共享的、统一管理的大量数据的集合 MySQL 是一款安全、跨平台、高效的，并与 PHP、Java 等主流编程语言紧密结合的数据库系统。该数据库系统是由瑞典的 MySQL AB 公司开发、发布并支持，由 MySQL 的初始开发人员 David Axmark 和 Michael Mo">
<meta property="og:locale">
<meta property="og:image" content="http://example.com/img/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%9C%BA%E6%9E%84.png">
<meta property="og:image" content="http://example.com/2023/04/13/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/mysql%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/img/%E9%A1%B5%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.png">
<meta property="og:image" content="http://example.com/img/%E9%A1%B5%E6%96%87%E4%BB%B6%E5%A4%B4.png">
<meta property="og:image" content="http://example.com/img/%E9%A1%B5%E5%A4%B4.png">
<meta property="og:image" content="http://example.com/img/Infimum-Supremum.png">
<meta property="og:image" content="http://example.com/img/Page-Directory1.png">
<meta property="og:image" content="http://example.com/img/%E9%A1%B5%E7%9A%84%E7%B1%BB%E5%9E%8B.png">
<meta property="og:image" content="http://example.com/img/b+%E6%A0%91%E7%B4%A2%E5%BC%95.png">
<meta property="og:image" content="http://example.com/img/Hash%E7%B4%A2%E5%BC%95.png">
<meta property="og:image" content="http://example.com/img/%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95.png">
<meta property="og:image" content="http://example.com/img/%E9%9D%9E%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95.png">
<meta property="og:image" content="http://example.com/img/%E7%BB%84%E5%90%88%E7%B4%A2%E5%BC%95.png">
<meta property="og:image" content="http://example.com/2023/04/13/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/mysql%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/img/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92.png">
<meta property="og:image" content="http://example.com/img/%E7%B4%A2%E5%BC%95%E7%A2%8E%E7%89%87%E7%9A%84%E4%BA%A7%E7%94%9F.png">
<meta property="article:published_time" content="2023-04-12T16:00:00.000Z">
<meta property="article:modified_time" content="2023-05-14T01:43:34.663Z">
<meta property="article:author" content="王霄">
<meta property="article:tag" content="mysql">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%9C%BA%E6%9E%84.png">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="WX" type="application/atom+xml">



    <link rel="shortcut icon" href="https://wxad.oss-cn-beijing.aliyuncs.com/favicon.ico">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">



<link rel="stylesheet" href="/css/style.css">




<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>mysql数据结构 | WX</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script>
        yiliaConfig.jquery_ui = [true, "//cdn.bootcss.com/jqueryui/1.10.4/jquery-ui.min.js", "//cdn.bootcss.com/jqueryui/1.10.4/css/jquery-ui.min.css"];
    </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






<meta name="generator" content="Hexo 6.3.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="https://wxad.oss-cn-beijing.aliyuncs.com/psb.jpg" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">王霄</a></h1>
        </hgroup>

        
        <p class="header-subtitle">夏天的风我永远记得</p>
        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <!--加滚动条-->
                    <nav class="header-menu" style="position:relative; height:400px; overflow-y:auto">
                        <ul style="position:relative; height:400px; overflow-y:auto">
                            
                                <li><a href="/">主页</a></li>
                            
                                <li><a href="/archives/">所有文章</a></li>
                            
                                <li><a href="/tags/">标签云</a></li>
                            
                                <li><a href="/about/">关于我</a></li>
                            
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:&#49;&#48;&#51;&#51;&#49;&#51;&#54;&#57;&#54;&#55;&#64;&#113;&#113;&#46;&#99;&#111;&#109;" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" rel="noopener" href="https://github.com/loveUUxad" title="GitHub"></a>
                            
                                <a class="fa Gitee" target="_blank" rel="noopener" href="https://gitee.com/loveUUxad" title="Gitee"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/activemq/" rel="tag">activemq</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gitlab/" rel="tag">gitlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java8/" rel="tag">java8</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" rel="tag">java并发编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B/" rel="tag">java引用类型</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jdk%E5%AE%89%E8%A3%85/" rel="tag">jdk安装</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jmeter/" rel="tag">jmeter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kafka/" rel="tag">kafka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lambda/" rel="tag">lambda</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mongodb/" rel="tag">mongodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nacos/" rel="tag">nacos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nosql/" rel="tag">nosql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rabbitmq/" rel="tag">rabbitmq</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/" rel="tag">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rocketmq/" rel="tag">rocketmq</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sentinel/" rel="tag">sentinel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springcloud/" rel="tag">springcloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zookeeper/" rel="tag">zookeeper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BB%A4%E7%89%8C%E6%A1%B6/" rel="tag">令牌桶</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95/" rel="tag">压力测试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8E%92%E5%BA%8F/" rel="tag">排序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%8D%E5%8A%A1%E9%99%8D%E7%BA%A7/" rel="tag">服务降级</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83/" rel="tag">注册中心</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%86%94%E6%96%AD/" rel="tag">熔断</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/" rel="tag">软件安装</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BF%9B%E5%88%B6%E8%BD%AC%E6%8D%A2/" rel="tag">进制转换</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83/" rel="tag">配置中心</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%99%90%E6%B5%81/" rel="tag">限流</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%99%90%E6%B5%81%E6%A1%86%E6%9E%B6/" rel="tag">限流框架</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2/" rel="tag">项目部署</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://github.com/loveUUxad">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">java开发工程师</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">王霄</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="https://wxad.oss-cn-beijing.aliyuncs.com/psb.jpg" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">王霄</a></h1>
            </hgroup>
            
            <p class="header-subtitle">夏天的风我永远记得</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:&#49;&#48;&#51;&#51;&#49;&#51;&#54;&#57;&#54;&#55;&#64;&#113;&#113;&#46;&#99;&#111;&#109;" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/loveUUxad" title="GitHub"></a>
                            
                                <a class="fa Gitee" target="_blank" href="https://gitee.com/loveUUxad" title="Gitee"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap"><article id="post-数据库/mysql/mysql数据结构" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2023/04/13/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/mysql%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" class="article-date">
      <time datetime="2023-04-12T16:00:00.000Z" itemprop="datePublished">2023-04-13</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      mysql数据结构
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="1-mysql数据库"><a href="#1-mysql数据库" class="headerlink" title="1. mysql数据库"></a>1. mysql数据库</h3><ul>
<li>数据库是 “按照数据结构来组织、存储和管理数据的仓库”。是一个长期存储在计算机内的、有组织的、可共享的、统一管理的大量数据的集合</li>
<li>MySQL 是一款安全、跨平台、高效的，并与 PHP、Java 等主流编程语言紧密结合的数据库系统。该数据库系统是由瑞典的 MySQL AB 公司开发、发布并支持，由 MySQL 的初始开发人员 David Axmark 和 Michael Monty Widenius 于 1995 年建立的。</li>
<li>MySQL 的象征符号是一只名为 Sakila 的海豚，代表着 MySQL 数据库的速度、能力、精确和优秀本质。</li>
</ul>
<span id="more"></span>
<h3 id="2-mysql数据结构"><a href="#2-mysql数据结构" class="headerlink" title="2. mysql数据结构"></a>2. mysql数据结构</h3><p>在 InnoDB 存储引擎中，所有的数据都被逻辑地存放在表空间中，表空间（tablespace）是存储引擎中最高的存储逻辑单位，在表空间的下面又包括段（segment）、区（extent）、页（page），他们之间的关系如下：</p>
<p><img src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E6%9C%BA%E6%9E%84.png"></p>
<h4 id="2-1-表空间（tablespace）"><a href="#2-1-表空间（tablespace）" class="headerlink" title="2.1 表空间（tablespace）"></a>2.1 表空间（tablespace）</h4><p>表空间是一种用于存储数据库对象 (如：数据文件)的逻辑空间，是Mysql中信息存储的最大逻辑单元</p>
<h5 id="2-1-1-系统表空间（System-Tablespace）"><a href="#2-1-1-系统表空间（System-Tablespace）" class="headerlink" title="2.1.1 系统表空间（System Tablespace）"></a>2.1.1 系统表空间（System Tablespace）</h5><p>就是我们常说的共享表空间，是我们在初始化mysql实例时生成的（在初始化mysql实例时会读取my.cnf中的innodb_data_file_path参数，然后初始出相应的文件ibdata1、ibdata2 …，至于文件多大，有多少个，看你my.cnf中的参数是怎样设置的）。mysql默认的系统表空间文件大小是12M，只有一个文件(ibdata1)，它默认是保存到你mysql实例的datadir变量的目录下</p>
<h5 id="2-1-2-表文件表空间（File-Per-Table-Tablespaces）"><a href="#2-1-2-表文件表空间（File-Per-Table-Tablespaces）" class="headerlink" title="2.1.2 表文件表空间（File-Per-Table Tablespaces）"></a>2.1.2 表文件表空间（File-Per-Table Tablespaces）</h5><p>表文件表空间是一个单表表空间，该表创建于自己的数据文件中，而非创建于系统表空间中。当innodb_file_per_table选项开启时，表将被创建于表文件表空间中。否则，innodb将被创建于系统表空间中。每个表文件表空间由一个.ibd数据文件代表，该文件默认被创建于相应数据库目录中。表文件表空间支持动态（DYNAMIC)和压缩（commpressed)行格式。</p>
<h5 id="2-1-3-通用表空间（General-Tablespaces）"><a href="#2-1-3-通用表空间（General-Tablespaces）" class="headerlink" title="2.1.3 通用表空间（General Tablespaces）"></a>2.1.3 通用表空间（General Tablespaces）</h5><p>通用表空间为通过create tablespace语法创建的共享表空间。通用表空间可以创建于mysql数据目录外的其他表空间，其可以容纳多张表，且其支持所有的行格式。通过create table tab_name … tablespace [&#x3D;] tablespace_name或alter table tab_name tablespace [&#x3D;] tablespace_name语法将其添加与通用表空间内，对应的数据库文件是mysql.ibd</p>
<h5 id="2-1-4-undo表空间（undo-tablespace）"><a href="#2-1-4-undo表空间（undo-tablespace）" class="headerlink" title="2.1.4 undo表空间（undo tablespace）"></a>2.1.4 undo表空间（undo tablespace）</h5><p>undo表空间由一个或多个包含undo日志的文件组成。innodb_undo_tablespace配置选项控制undo表空间的数目。undo表空间创建于innodb_undo_directory配置选项确定的位置，该选项典型被用于将undo日志放于不同的存储设备上。如果该选项没有确定任何路径，undo表空间则被默认创建于mysql数据目录（datadir）下。</p>
<h5 id="2-1-5-临时表空间（Temporary-Tablespace）"><a href="#2-1-5-临时表空间（Temporary-Tablespace）" class="headerlink" title="2.1.5 临时表空间（Temporary Tablespace）"></a>2.1.5 临时表空间（Temporary Tablespace）</h5><p>用户创建的临时表和磁盘内部临时表创建于共享临时表空间中。innodb_temp_data_file选项确定临时表空间数据文件的相对路径、名字、大小和属性等。如果该选项未确定任何值，默认情况下，系统将在innodb_data_home_dir确定的目录下创建一个叫ibtmp1的自动扩展的数据文件，该文件将稍大于12m。</p>
<blockquote>
<p>接下来我们去数据库安装目录下熟悉熟悉这些文件</p>
</blockquote>
<p>– 显示数据库的存储目录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;datadir&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>– 进入到该位置</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker ps</span><br><span class="line">docker exec -it 7a1da4192642 /bin/bash</span><br><span class="line">cd /var/lib/mysql</span><br></pre></td></tr></table></figure>
<h4 id="2-2-页（page）"><a href="#2-2-页（page）" class="headerlink" title="2.2 页（page）"></a>2.2 页（page）</h4><h5 id="2-2-1-页的介绍"><a href="#2-2-1-页的介绍" class="headerlink" title="2.2.1 页的介绍"></a>2.2.1 页的介绍</h5><ul>
<li>InnoDB将数据<strong>逻辑上</strong>划分为若干个页，InnoDB中页的大小默认为16KB</li>
<li>页作为磁盘和内存之间交互的基本单位，也就是一次最少从磁盘中读取16KB的内容到内存中，一次最少把内存中16KB内容刷新到磁盘中</li>
<li>在数据库中，不论读一行，还是读多行，都是将这些行所在的页进行加载，即数据库I&#x2F;O操作的最小单位是页。</li>
<li>页不仅仅是IO的最小单位，它还是所有关系的最小单位，也就是说，如果一个页包含了表A的行，那么它将只包含表A的行</li>
<li>页与页之间通过双向链表连接，一个页中存储多个行记录，记录与记录之间通过单向链表连接。</li>
</ul>
<h5 id="2-2-2-页的数据结构"><a href="#2-2-2-页的数据结构" class="headerlink" title="2.2.2 页的数据结构"></a>2.2.2 页的数据结构</h5><img src="img/页的数据结构.png" align='left'/>

<ul>
<li>File Header：文件头，描述页的信息<br><img src="/img/%E9%A1%B5%E6%96%87%E4%BB%B6%E5%A4%B4.png"></li>
</ul>
<hr>
<p>主要先看下如下的一些信息：</p>
<pre><code>- FIL_PAGE_SPACE_OR_CHKSUM

这个代表当前页面的校验和（checksum），每当一个页面在内存中修改了，在同步之前就要把它的校验和算出来。在一个页面被刷到磁盘的时候，首先被写入磁盘的就是这个 checksum。

- FIL_PAGE_OFFSET

每一个页都有一个单独的页号，InnoDB 通过页号来唯一定位一个页。如某独立表空间 a.ibd 的大小为1GB，页的大小默认为16KB，那么总共有65536个页。FIL_PAGE_OFFSET 表示该页在所有页中的位置。若此表空间的ID为10，那么搜索页（10，1）就表示查找表a中的第二个页。

- FIL_PAGE_PREV 和 FIL_PAGE_NEXT

InnoDB 是以页为单位存放数据的，InnoDB 表是索引组织的表，数据是按主键顺序存放的。数据可能会分散到多个不连续的页中存储，这时就会通过 FIL_PAGE_PREV 和 FIL_PAGE_NEXT 将上一页和下一页连起来，就形成了一个双向链表。这样就通过一个双向链表把许许多多的页就都串联起来了，而无需这些页在物理上真正连着。
- FIL_PAGE_TYPE

这个代表当前页的类型，InnoDB 为了不同的目的而设计了许多种不同类型的页。
</code></pre>
<hr>
<ul>
<li><p>Page Header：页头，页的状态信息<br><img src="/img/%E9%A1%B5%E5%A4%B4.png"></p>
</li>
<li><p>Infimum + Supremum：最大和最小记录，这是两个虚拟的行记录<br><img src="/img/Infimum-Supremum.png"></p>
</li>
<li><p>User Records：用户记录，存储行记录内容</p>
</li>
<li><p>Free Space：空闲记录，页中还没有被使用的空间</p>
</li>
<li><p>Page Directory：页目录，存储用户记录的相对位置<br><img src="/img/Page-Directory1.png"></p>
<pre><code>首先我们要知道，InnoDB 的数据是索引组织的，B+树索引本身并不能找到具体的一条记录，只能找到该记录所在的页，页是存储数据的最小基本单位。如下图，如果我们要查找 ID=32 的这行数据，通过索引只能定位到第 17 页。
定位到页之后我们可以通过最小记录Infimum的记录头的next_record沿着链表一直往后找，就可以找到 ID=32 这条记录了。
但是可以想象，沿着链表顺序查找的性能是很低的。所以，页中的数据其实是分为多个组的，这看起来就形成了一个子目录，通过子目录就能缩小查询的范围，提高查询性能了。
Page Directory 翻译过来就是页目录，这部分存放的就是一个个的槽（Slot），页中的记录分为了多个组，槽就存放了每个组中最大的那条记录的相对位置（记录在页中的相对位置，不是偏移量）。这个组有多少条记录，就通过最大记录的记录头中的 n_owned 来表示。有了目录槽之后，InnoDB就会利用二叉查找迅速确定记录所在的槽，并找到该槽所在分组中主键值最小的那条记录，再通过最小记录的 next_record 遍历记录，就能快速定位到匹配的那条记录了。
</code></pre>
</li>
<li><p>File Tailer：文件尾，校验页是否完整</p>
<pre><code>前面介绍 File Header 时说过，在将页写入磁盘时，最先写入的便是 File Header 中的 FIL_PAGE_SPACE_OR_CHKSUM 值，就是页面的校验和。在写入的过程中，数据库可能发生宕机，导致页没有完整的写入磁盘。为了校验页是否完整写入磁盘，InnoDB 就设置了 File Trailer 部分。File Trailer 中只有一个FIL_PAGE_END_LSN，占用8字节。FIL_PAGE_END_LSN 又分为两个部分，前4字节代表页的校验和；后4字节代表页面被最后修改时对应的日志序列位置（LSN），与File Header中的FIL_PAGE_LSN相同。默认情况下，InnoDB存储引擎每次从磁盘读取一个页就会检测该页的完整性，这时就会将 File Trailer 中的校验和、LSN 与 File Header 中的 FIL_PAGE_SPACE_OR_CHKSUM、FIL_PAGE_LSN 进行比较，以此来保证页的完整性。
</code></pre>
</li>
</ul>
<h5 id="2-2-3-页的类型"><a href="#2-2-3-页的类型" class="headerlink" title="2.2.3 页的类型"></a>2.2.3 页的类型</h5><p>– InnoDB 为了不同的目的而设计了许多种不同类型的<br><img src="/img/%E9%A1%B5%E7%9A%84%E7%B1%BB%E5%9E%8B.png"></p>
<h4 id="2-3-区（extent）"><a href="#2-3-区（extent）" class="headerlink" title="2.3 区（extent）"></a>2.3 区（extent）</h4><ul>
<li><p>区是页的集合，一个区包含64个连续的页，默认大小为 1MB (64*16K)。</p>
</li>
<li><p>通常，区和页一样，是所有关系的单位，如果区中的一个页从属于表A或者索引B，那么区中的所有8个页都会从属于一个相同的对象。对于很小的表或者索引来说，情况会有所不同，它们不能充满整个区，在这种情况下， 超过一个表或者索引会被定位到一个相同的区中，但对于大部分对象来说，区仍是所有关系的单位。</p>
</li>
<li><p>所以说数据库不认为表扫描是读取表的所有行，它认为表扫描是读取表的所有页或者区，它知道它将很可能并发的处理16K，64K的IO请求来读取整个表，这将使得表扫描变得不至于像每行读取那样吓人。</p>
</li>
<li><p>读取页和区不仅意味着做一个表扫描比我们期望的具有更少的工作，它还意味着，为了从非聚集索引受益，一个查询应该比我们期望的更具有选择性</p>
<p><strong>理解举例：</strong>假设有一张10W条记录的学生表,该表有主键索引id，非聚簇索引age</p>
<p>假设每页能够存100条数据，则10W条数据被分成了1000页</p>
<p>如果我们现在需要查询年龄大于18岁的学生 ，已知年龄大于18岁的学生总共有2000个，占总学生的2%，可以这样理解平均每50个学生中就有一个大于18岁的，我们每次查询就需要从50行中选择一行，那么平均每个页变会包含2个请求行，则平均每个页都包含了至少1个请求行，换句话说，几乎每个页都 需要被读取来满足这个查询，那么用表扫描来读取它们是最好的选择，一次读取一个区，平均每次都装在16（2*8）个请求行进入内存</p>
<p>|   id   |  name  |  age   |<br>| :—-: | :—-: | :—-: |<br>|   1    |  张三  |   18   |<br>|   2    |  李四  |   14   |<br>|   3    |  王五  |   13   |<br>| …… | …… | …… |</p>
</li>
</ul>
<h4 id="2-4-段（segment）"><a href="#2-4-段（segment）" class="headerlink" title="2.4 段（segment）"></a>2.4 段（segment）</h4><p>段(Segment)分为索引段，数据段，回滚段等。其中索引段就是非叶子结点部分，而数据段就是叶子结点部分，回滚段用于数据的回滚和多版本控制。一个段包含256个区(256M大小)。</p>
<h3 id="3-数据库引擎"><a href="#3-数据库引擎" class="headerlink" title="3. 数据库引擎"></a>3. 数据库引擎</h3><h4 id="3-1-引擎是什么？"><a href="#3-1-引擎是什么？" class="headerlink" title="3.1 引擎是什么？"></a>3.1 引擎是什么？</h4><p>MySQL中的数据用各种不同的技术存储在文件(或者内存)中。这些技术中的每一种技术都使用不同的存储机制、索引技巧、锁定水平并且最终提供广泛的不同的功能和能力。通过选择不同的技术，你能够获得额外的速度或者功能，从而改善你的应用的整体功能。</p>
<blockquote>
<pre><code>查看支持的引擎
</code></pre>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> engines;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-常用的引擎"><a href="#3-2-常用的引擎" class="headerlink" title="3.2 常用的引擎"></a>3.2 常用的引擎</h4><h5 id="3-2-1-InnoDB"><a href="#3-2-1-InnoDB" class="headerlink" title="3.2.1 InnoDB"></a>3.2.1 InnoDB</h5><p>InnoDB是MySQL默认的事务型引擎，也是最重要、最广泛的存储引擎。它的设计是用来处理大量短期事务，短期事务大部分是正常提交的，很少回滚。InnoDB的性能和自动崩溃恢复特性，使得它在非事务型存储的需求中，也很流行。除了非常特别的原因需要使用其他引擎，InnoDB也是非常好值得花时间研究的对象。</p>
<p>InnoDB的数据存储在表空间中，表空间是由InnoDB管理的黑盒文件系统，由一系列系统文件组成。InnoDB可以将每个表的数据和索引存放在单独的文件中。InnoDB也可以使用裸设备作为表空间存储介质。</p>
<p>InnoDB通过间隙锁（next-key locking）防止幻读的出现。InnoDB是基于聚簇索引建立，与其他存储引擎有很大的区别，聚簇索引对主键查询有很高的性能，不过它的二级索引（secondary index，非主键索引）必须包含主键列。所以如果主键列很大的话，索引会很大。</p>
<h5 id="3-2-2-MyISAM"><a href="#3-2-2-MyISAM" class="headerlink" title="3.2.2 MyISAM"></a>3.2.2 MyISAM</h5><p>在5.1之前，MyISAM是默认的引擎，MyISAM有大量的特心态，包括全文索引、压缩、空间函数。但是MyISAM不支持事务和行级锁，而且在崩溃后无法安全恢复。即使后续版本中MyISAM支持了事务，但是很多人的概念中依然是不支持事务的引擎。</p>
<p>MyISAM并不是无所事处。对于一些只读数据，或者表空间较小，可以忍受恢复操作，可以使用MyISAM。MyISAM会将表存储在两个文件中：数据文件、索引文件。分别是.MYD、.MYI扩展名。MyISAM表可以包含动态或者静态行。MySQL会根据表定义选择那种行格式。MyISAM表的行记录数，取决于磁盘空间和操作系统中的单个文件最大尺寸。</p>
<p>在MySQL中，默认配置只能存储256TB的数据。因为指向数据记录的指针长度是6字节。需要修改可以修改表的MAX_ROWS和AVG_ROW_LENGTH选项。两个相乘是最大的大小。会导致重建索引。</p>
<p>MyISAM是对整个表加锁，而不是行锁，读取的时候对表加共享锁，写入的时候加排他锁。但是在表有读取查询的同时，也可以往表内写入记录。</p>
<p>对于MyISAM，即使是Blob，Text等等长字段，也可以基于前500字符创建索引，MyISAM支持全文索引，这是一个基于分词创建的索引，也可以支持复杂的查询。</p>
<p>MyISAM可以选择延迟更新索引键，在创建表的时候指定delay_key_write选项，在每次修改执行完成时，不会立刻将修改的索引数据写入磁盘，而是写到缓存区，只有在清理缓存区或者关闭表的时候才会将索引写入磁盘。这可以极大的提升写入性能，但是在主机崩溃时会造成索引损坏，需要执行修复操作。</p>
<p>MyISAM另一个特性是支持压缩表。如果数据在写入后不会修改，那么这个表适合MyISAM压缩表。可以使用myisampack对MyISAM表进行打包，压缩表是不可以修改数据的。压缩表可以极大的减少磁盘占用，因此可以减少磁盘IO，提升性能，压缩表也支持索引，但是索引也是只读的。</p>
<p>整体来说MyISAM并没有那么不堪，但是由于没有行锁机制，所以在海量写入的时候，会导致所有查询处于Locked状态。</p>
<h5 id="3-2-3-Archive"><a href="#3-2-3-Archive" class="headerlink" title="3.2.3 Archive"></a>3.2.3 Archive</h5><p>Archive引擎支持是Insert，Select操作，现在支持索引，Archive引擎会缓存所有的写，并利用zlib对写入行进行压缩，所以比MyISAM表的磁盘IO更少。但是在每次Select查询都需要执行全表扫描。所以在Archive适合日志和数据采集应用。这类应用在分析时往往需要全表扫描忙活着更快的Insert操作场景中也可以使用。</p>
<p>Archive引擎支持行级锁和专用的缓存区，所以可以实现高并发写入，在查询开始到返回表存在的所有行数之前，Archive会阻止其他Select执行，用来实现一致性读。另外也实现了批量写入结束前批量写入数据对读操作不可见，这种机制模仿了事务和MVCC的特性，但是Archive不是一个事务型引擎，而是针对高写入压缩做了优化的简单引擎。</p>
<h5 id="3-2-4-Blackhole"><a href="#3-2-4-Blackhole" class="headerlink" title="3.2.4 Blackhole"></a>3.2.4 Blackhole</h5><p>Blackhole没有实现任何存储机制，它会舍弃所有写入数据，不做任何保存，但是服务器会记录Blackhole表的日志，用于复制数据到备库，或者只是简单的记录到日志，这种特殊的存储引擎可以在一些特俗的复制架构和日志审核时发挥作用。但是不推荐。</p>
<h5 id="3-2-5-CSV"><a href="#3-2-5-CSV" class="headerlink" title="3.2.5 CSV"></a>3.2.5 CSV</h5><p>CSV引擎可以将普通的CSV文件作为MySQL表来处理，但是这种表不支持索引，CSV可以在数据库运行时拷贝或者拷出文件，可以将Excel等电子表格中的数据存储未CSV文件，然后复制到MySQL中，就能在MySQL中打开使用。同样，如果将数据写入到一个CSV引擎表，其他外部程序也可以从表的数据文件中读取CSV的数据。因此CSV可以作为数据交换机制。非常好用。</p>
<h5 id="3-2-6-Federated"><a href="#3-2-6-Federated" class="headerlink" title="3.2.6 Federated"></a>3.2.6 Federated</h5><p>Federated引擎是访问其他MySQL服务器的一个代理，它会创建一个到远程MySQL服务器的客户端连接，并将查询传输到远程服务器执行，然后提取或者发送需要的数据。最初设计该存储引擎是为了和企业级数据库如MicrosoftSQLServer和Oracle的类似特性竞争的，可以说更多的是一种市场行为。尽管该引擎看起来提供了一种很好的跨服务器的灵活性，但也经常带来问题，因此默认是禁用的。</p>
<h5 id="3-2-7-Memroy"><a href="#3-2-7-Memroy" class="headerlink" title="3.2.7 Memroy"></a>3.2.7 Memroy</h5><p>如果需要快速地访问数据，并且这些数据不会被修改，重启以后丢失也没有关系，那么使用Memory表（以前也叫做HEAP表）是非常有用的。Memory表至少比MyISAM表要快一个数量级，因为所有的数据都保存在内存中，不需要进行磁盘I&#x2F;O。Memory表的结构在重启以后还会保留，但数据会丢失。</p>
<p>Memroy表在很多场景可以发挥好的作用：</p>
<p>用于查找（lookup）或者映射（mapping）表，例如将邮编和州名映射的表。<br>用于缓存周期性聚合数据（periodicallyaggregateddata）的结果。<br>用于保存数据分析中产生的中间数据。<br>Memory表支持Hash索引，因此查找操作非常快。虽然Memory表的速度非常快，但还是无法取代传统的基于磁盘的表。Memroy表是表级锁，因此并发写入的性能较低。它不支持BLOB或TEXT类型的列，并且每行的长度是固定的，所以即使指定了VARCHAR列，实际存储时也会转换成CHAR，这可能导致部分内存的浪费。如果MySQL在执行查询的过程中需要使用临时表来保存中间结果，内部使用的临时表就是Memory表。如果中间结果太大超出了Memory表的限制，或者含有BLOB或TEXT字段，则临时表会转换成MyISAM表。</p>
<h5 id="3-2-8-Merge"><a href="#3-2-8-Merge" class="headerlink" title="3.2.8 Merge"></a>3.2.8 Merge</h5><p>Merge引擎是MyISAM引擎的一个变种。Merge表是由多个MyISAM表合并而来的虚拟表。如果将MySQL用于日志或者数据仓库类应用，该引擎可以发挥作用。但是引入分区功能后，该引擎已经被放弃</p>
<h5 id="3-2-9-NDB"><a href="#3-2-9-NDB" class="headerlink" title="3.2.9 NDB"></a>3.2.9 NDB</h5><p>NDB集群存储引擎，作为SQL和NDB原生协议之间的接口。MySQL服务器、NDB集群存储引擎，以及分布式的、share-nothing的、容灾的、高可用的NDB数据库的组合，被称为MySQL集群（MySQLCluster）。</p>
<h3 id="4-数据库索引"><a href="#4-数据库索引" class="headerlink" title="4. 数据库索引"></a>4. 数据库索引</h3><p>数据库索引指的是数据库管理系统中一个排序的数据结构，以协助快速查询、更新数据库表中的数据。简单理解就是类似书籍的目录，独立于书籍内容之外，能够快速根据目录查到到需要的文章的页码。如果没有目录，我们就要一页一页地翻页来查找文章，同理，如果没有索引的话，数据库系统只能一行一行地查找数据</p>
<blockquote>
<p>优劣势</p>
</blockquote>
<ul>
<li>所有的MySql列类型(字段类型)都可以被索引，也就是可以给任意字段设置索引。</li>
<li>大大加快数据的查询速度。</li>
<li>实际上索引也是一张表，该表保存了主键与索引字段，并指向实体表的记录，所以索引列也是要占用空间的。</li>
<li>虽然索引大大提高了查询速度，同时却会降低更新表的速度，如对表进行INSERT、UPDATE和DELETE。因为更新表时，MySQL不仅要保存数据，还要保存一下索引文件每次更新添加了索引列的字段，都会调整因为更新所带来的键值变化后的索引信息。</li>
<li>索引只是提高效率的一个因素，如果你的MySQL有大数据量的表，就需要花时间研究建立最优秀的索引，或者优化查询。</li>
</ul>
<h4 id="4-1-索引分类"><a href="#4-1-索引分类" class="headerlink" title="4.1 索引分类"></a>4.1 索引分类</h4><blockquote>
<p><strong>按数据结构分类</strong>：B+tree索引、Hash索引、Full-text索引。<br><strong>按物理存储分类</strong>：聚集索引、非聚集索引（也叫二级索引、辅助索引）。<br><strong>按字段特性分类</strong>：主键索引(PRIMARY KEY)、唯一索引(UNIQUE)、普通索引(INDEX)、全文索引(FULLTEXT)。<br><strong>按字段个数分类</strong>：单列索引、联合索引（也叫复合索引、组合索引）。</p>
</blockquote>
<h5 id="4-1-1-按数据结构分类"><a href="#4-1-1-按数据结构分类" class="headerlink" title="4.1.1 按数据结构分类"></a>4.1.1 按数据结构分类</h5><h6 id="4-1-1-1-B-tree索引"><a href="#4-1-1-1-B-tree索引" class="headerlink" title="4.1.1.1 B+tree索引"></a>4.1.1.1 B+tree索引</h6><p>B+tree 是在B树基础上的一种优化，其更适合做存储索引结构。在 B+tree 中，非叶子节点上仅存储键值，不存储数据；而所有数据记录均存储在叶子节点上，并且数据是按照顺序排列的。此外在 B+tree 中各个数据页之间是通过双向链表连接的，叶子节点中的数据是通过单向链表连接的。B+tree 的结构图如下：<br><img src="/img/b+%E6%A0%91%E7%B4%A2%E5%BC%95.png"></p>
<hr>
<p>B+tree 结构实现数据索引具有如下优点：</p>
<pre><code>* 非叶子节点上可以存储更多的键值，相应的树的阶数（节点的子节点树）就会更大，树也就会变得更矮更胖。这样一来我们查找数据进行磁盘I/O的次数就会大大减少，数据查询的效率也会更快，在生产环境，一般树的层级为3-4层
* 所有数据记录都有序存储在叶子节点上，就会使得范围查找，排序查找，分组查找以及去重查找变得异常简单。
* 数据页之间、数据记录之间都是通过链表链接的，有了这个结构的支持就可以方便的在数据查询后进行升序或者降序操作。
</code></pre>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/2woods/p/9978011.html">怎样查询InnoDB树的层级</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_33989058/article/details/89564340">InnoDB系统表介绍</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_37102984/article/details/124296196#:~:text=B%2B%E6%A0%91%E4%B8%80%E8%88%AC%E6%9C%89%E4%B8%A4%E5%88%B0,O%EF%BC%8C%E6%80%A7%E8%83%BD%E4%B9%9F%E8%BF%98%E8%A1%8C%E3%80%82">层级计算</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> b.name 表名称,</span><br><span class="line">         a.name 索引名称,</span><br><span class="line">         a.index_id 索引ID,</span><br><span class="line">         a.type 索引类型,</span><br><span class="line">         a.space,</span><br><span class="line">         a.PAGE_NO</span><br><span class="line"><span class="keyword">FROM</span> information_schema.INNODB_INDEXES a, information_schema.INNODB_TABLES b</span><br><span class="line"><span class="keyword">WHERE</span> a.table_id <span class="operator">=</span> b.table_id</span><br><span class="line">        <span class="keyword">AND</span> a.space <span class="operator">&lt;&gt;</span> <span class="number">0</span></span><br><span class="line">		</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> variables <span class="keyword">like</span> <span class="string">&#x27;innodb_page_size&#x27;</span>		</span><br></pre></td></tr></table></figure>

<h6 id="4-1-1-2-Hash索引"><a href="#4-1-1-2-Hash索引" class="headerlink" title="4.1.1.2 Hash索引"></a>4.1.1.2 Hash索引</h6><p><img src="/img/Hash%E7%B4%A2%E5%BC%95.png"></p>
<p>Hash索引是基于Hash算法实现的，如上图所示，我们将一系列的最终的键值通过哈希函数转化为存储实际数据桶的地址数值。值本身存储的地址就是基于哈希函数的计算结果，而搜索的过程就是利用哈希函数从元数据中推导出桶的地址。（对Hash算法不太理解就往这里看：HashMap核心知识-深度学习） 所以基于Hash索引结构的特殊性，其检索效率非常高，索引的检索可以一次定位，不像B+Tree索引需要从根节点到枝节点，最后才能访问到页节点这样多次的I&#x2F;O访问，所以Hash索引在精确查询时的效率要远高于B+Tree索引。虽然Hash索引效率高，但是Hash索引本身由于其特殊性也带来了很多限制和弊端，主要有以下这些：</p>
<blockquote>
<p>Hash索引仅仅能满足等值查询，不能进行范围查询</p>
</blockquote>
<pre><code>由于Hash索引比较的是进行Hash运算之后的Hash值，所以它只能用于等值的过滤，不能用于基于范围的过滤，因为经过相应的Hash算法处理之后的Hash值的大小关系，并不能保证和Hash运算前完全一样。
</code></pre>
<blockquote>
<p>Hash索引无法通过操作索引来排序</p>
</blockquote>
<pre><code>由于 Hash索引中存放的是经过 Hash 计算之后的Hash值，而且Hash值的大小关系并不一定和Hash运算前的键值完全一样，所以数据库无法利用索引的数据来避免任何排序运算。
</code></pre>
<blockquote>
<p>组合Hash索引不能利用部分索引键进行查询</p>
</blockquote>
<pre><code>对于组合Hash索引，索引在计算 Hash 值的时候是组合索引键合并后再一起计算 Hash 值，而不是单独计算 Hash值，所以通过组合索引的前面一个或几个索引键进行查询的时候，Hash 索引也无法被利用。
</code></pre>
<blockquote>
<p>Hash索引依然需要回表扫描</p>
</blockquote>
<pre><code>Hash索引是将索引键通过 Hash 运算之后，将Hash运算结果的Hash值和所对应的行指针信息存放于一个 Hash 表中，由于不同索引键可能存在相同 Hash 值，所以即使取满足某个 Hash 键值的数据的记录条数，也无法从Hash索引中直接完成查询，还是要通过访问表中的实际数据进行相应的比较，并得到相应的结果。
</code></pre>
<blockquote>
<p>Hash索引遇到大量Hash值相等的情况后性能并不一定就会比B+Tree索引高</p>
</blockquote>
<pre><code>区分度低的索引键（如，性别），如果创建Hash索引，那么将会存在大量记录指针信息与同一个Hash值相关联。这样要定位某一条记录时就会非常麻烦，会浪费多次表数据的访问，而造成整体性能低下。
</code></pre>
<h6 id="4-1-1-3-Full-text索引"><a href="#4-1-1-3-Full-text索引" class="headerlink" title="4.1.1.3 Full-text索引"></a>4.1.1.3 Full-text索引</h6><p>Full-text索引一般使用倒排索引实现。倒排索引同B+tree索引一样，也是一种索引结构。</p>
<p>MySQL中InnoDB存储引擎在之前版本中是不支持全文检索的，要使用全文检索的话只能使用MySIAM存储引擎。在 MySQL 5.6.4 版本中InnoDB存储引擎才开始支持Full-text索引。</p>
<p>对于文本类型的大对象，或者较大的CHAR类型的数据，如果使用普通索引，那么匹配文本前几个字符还是可行的，但是想要匹配文本中间的几个单词，那么就要使用LIKE %word%来匹配，这样需要很长的时间来处理，响应时间会大大增加，这种情况，就可使用时FULLTEXT索引了，在生成FULLTEXT索引时，会为文本生成一份单词的清单，在索引时及根据这个单词的清单来索引。</p>
<p>Full-text索引的查询有自己特殊的语法，而不能使用 LIKE 模糊查询的语法，语法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name <span class="keyword">MATCH</span>(ft_index) AGAINST(<span class="string">&#x27;查询字符串&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h5 id="4-1-2-按物理存储分类"><a href="#4-1-2-按物理存储分类" class="headerlink" title="4.1.2 按物理存储分类"></a>4.1.2 按物理存储分类</h5><h6 id="4-1-2-1-聚簇索引"><a href="#4-1-2-1-聚簇索引" class="headerlink" title="4.1.2.1 聚簇索引"></a>4.1.2.1 聚簇索引</h6><p><img src="/img/%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95.png"></p>
<ul>
<li>聚簇索引就是按照每张表的主键构造一颗 B+tree，同时叶子节点中存放的就是整张表的行记录数据，聚集索引的叶子节点被称为数据页。</li>
<li>InnoDB表要求必须有聚簇索引，默认在主键字段上建立聚簇索引，在没有主键字段的情况下，表的第一个非空的唯一索引将被建立为聚簇索引，在前两者都没有的情况下，InnoDB将自动生成一个隐式的自增id列，并在此列上建立聚簇索引。</li>
<li>InnoDB 有且只能有一个聚簇索引，为什么？</li>
</ul>
<h6 id="4-1-2-2-非聚集索引"><a href="#4-1-2-2-非聚集索引" class="headerlink" title="4.1.2.2 非聚集索引"></a>4.1.2.2 非聚集索引</h6><p><img src="/img/%E9%9D%9E%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95.png"></p>
<p>非聚集索引的结构和聚集索引基本相同（非叶子结点存储的都是索引指针），区别在于叶子节点存放的不是行数据而是数据主键。因此在使用非聚集索引进行查找时，需要先查找到主键值，然后再到聚集索引中进行查找。</p>
<p>回表是什么？通俗的讲就是，如果索引的列在 select 所需获得的列中（因为在 mysql 中索引是根据索引列的值进行排序的，所以索引节点中存在该列中的部分值）或者根据一次索引查询就能获得记录就不需要回表，如果 select 所需获得列中有大量的非索引列，索引就需要到表中找到相应的列的信息，这就叫回表</p>
<h6 id="4-1-2-3-二级索引-覆盖索引"><a href="#4-1-2-3-二级索引-覆盖索引" class="headerlink" title="4.1.2.3 二级索引(覆盖索引)"></a>4.1.2.3 二级索引(覆盖索引)</h6><p>二级索引属于非聚簇索引的另一种分类，区别在于叶子节点除了存放数据主键之外还可以储存表中其他的字段，来进一步减小查询的开销</p>
<h5 id="4-1-3-按物理存储分类"><a href="#4-1-3-按物理存储分类" class="headerlink" title="4.1.3 按物理存储分类"></a>4.1.3 按物理存储分类</h5><h6 id="4-1-3-1-主键索引-PRIMARY-KEY"><a href="#4-1-3-1-主键索引-PRIMARY-KEY" class="headerlink" title="4.1.3.1 主键索引(PRIMARY KEY)"></a>4.1.3.1 主键索引(PRIMARY KEY)</h6><p>它是一种特殊的唯一索引，不允许有空值。一般是在建表的时候指定了主键，就会创建主键索引， CREATE INDEX不能用来创建主键索引，使用 ALTER TABLE来代替</p>
<h6 id="4-1-3-2-唯一索引-UNIQUE"><a href="#4-1-3-2-唯一索引-UNIQUE" class="headerlink" title="4.1.3.2 唯一索引(UNIQUE)"></a>4.1.3.2 唯一索引(UNIQUE)</h6><p>与普通索引类似，不同的就是：索引列的值必须唯一，但允许有一个空值。如果是组合索引，则列值的组合必须一</p>
<h6 id="4-1-3-3-普通索引-INDEX"><a href="#4-1-3-3-普通索引-INDEX" class="headerlink" title="4.1.3.3 普通索引(INDEX)"></a>4.1.3.3 普通索引(INDEX)</h6><p>这是最基本的索引，它没有任何限制</p>
<h6 id="4-1-3-4-全文索引-FULLTEXT"><a href="#4-1-3-4-全文索引-FULLTEXT" class="headerlink" title="4.1.3.4 全文索引(FULLTEXT)"></a>4.1.3.4 全文索引(FULLTEXT)</h6><p>FULLTEXT索引用于全文搜索。只有InnoDB和 MyISAM存储引擎支持 FULLTEXT索引和仅适用于 CHAR， VARCHAR和 TEXT列。</p>
<h5 id="4-1-4-按字段个数分类"><a href="#4-1-4-按字段个数分类" class="headerlink" title="4.1.4 按字段个数分类"></a>4.1.4 按字段个数分类</h5><h6 id="4-1-4-1-单列索引"><a href="#4-1-4-1-单列索引" class="headerlink" title="4.1.4.1 单列索引"></a>4.1.4.1 单列索引</h6><p>只包含一个字段的索引叫做单列索引</p>
<h6 id="4-1-4-2-联合索引"><a href="#4-1-4-2-联合索引" class="headerlink" title="4.1.4.2 联合索引"></a>4.1.4.2 联合索引</h6><p><img src="/img/%E7%BB%84%E5%90%88%E7%B4%A2%E5%BC%95.png"></p>
<p>包含两个或以上字段的索引叫做复合索引（或组合索引）。建立复合索引时，字段的顺序极其重要</p>
<p>一个例子，以index(a,b,c)复合索引为例：</p>
<table>
<thead>
<tr>
<th align="left">语句</th>
<th align="left">索引是否生效</th>
</tr>
</thead>
<tbody><tr>
<td align="left">where a &#x3D; 1</td>
<td align="left">是，字段 a 索引生效</td>
</tr>
<tr>
<td align="left">where a &#x3D; 1 and b &#x3D; 2</td>
<td align="left">是，字段 a 和 b 索引生效</td>
</tr>
<tr>
<td align="left">where a &#x3D; 1 and b &#x3D; 2 and c &#x3D; 3</td>
<td align="left">是，全部生效</td>
</tr>
<tr>
<td align="left">where b &#x3D; 2 and a &#x3D; 1 and c &#x3D; 3</td>
<td align="left">是，全部生效</td>
</tr>
<tr>
<td align="left">where b &#x3D; 2 或 where c &#x3D; 3</td>
<td align="left">否</td>
</tr>
<tr>
<td align="left">where a &#x3D; 1 and c &#x3D; 3</td>
<td align="left">字段 a 生效，字段 c 失效</td>
</tr>
<tr>
<td align="left">where a &#x3D; 1 and b &gt; 2 and c &#x3D; 3</td>
<td align="left">字段 a，b 生效，字段 c 失效</td>
</tr>
<tr>
<td align="left">where a &#x3D; 1 and b like ‘xxx%’ and c &#x3D; 3</td>
<td align="left">字段 a，b 生效，字段 c 失效</td>
</tr>
<tr>
<td align="left">……</td>
<td align="left">……</td>
</tr>
</tbody></table>
<ul>
<li><strong>最左前缀匹配原则，非常重要的原则</strong></li>
</ul>
<p>mysql会一直向右匹配直到遇到范围查询(&gt;、&lt;、between、like)就停止匹配，比如a 1&#x3D;”” and&#x3D;”” b&#x3D;”2” c&#x3D;”“&gt; 3 and d &#x3D; 4 如果建立(a,b,c,d)顺序的索引，d是用不到索引的，如果建立(a,b,d,c)的索引则都可以用到，a,b,d的顺序可以任意调整。</p>
<ul>
<li><strong>&#x3D;和in可以乱序</strong></li>
</ul>
<p>比如a &#x3D; 1 and b &#x3D; 2 and c &#x3D; 3 建立(a,b,c)索引可以任意顺序，mysql的查询优化器会帮你优化成索引可以识别的形式</p>
<h4 id="4-2-哪些情况需要创建索引"><a href="#4-2-哪些情况需要创建索引" class="headerlink" title="4.2 哪些情况需要创建索引"></a>4.2 哪些情况需要创建索引</h4><ul>
<li>主键自动建立唯一索引</li>
<li>频繁作为查询条件的字段应该创建索引</li>
<li>查询中与其它表关联的字段，外键关系建立索引</li>
<li>单键&#x2F;组合索引的选择问题，who？（在高并发下倾向创建组合索引）</li>
<li>查询中排序的字段，排序字段若通过索引去访问将大大提高排序速度</li>
<li>查询中统计或者分组字段</li>
</ul>
<h4 id="4-3-哪些情况不需要创建索引"><a href="#4-3-哪些情况不需要创建索引" class="headerlink" title="4.3 哪些情况不需要创建索引"></a>4.3 哪些情况不需要创建索引</h4><ul>
<li>表记录太少</li>
<li>where条件里用不到的字段不创建索引</li>
<li>频繁更新的字段不适合创建索引，因为每次更新不单单是更新了记录，还会更新索引，加重IO负担</li>
<li>经常增删改的表：虽然提高了查询速度，同时却会降低更新表的速度，如对表进行INSERT、UPDATE和DELETE。因为更新表时，MySQL不仅要保存数据，还要保存一下索引文件。</li>
<li>数据重复且分布平均的表字段，因此应该只为最经常查询和最经常排序的数据列建立索引。注意，如果某个数据列包含许多重复的内容，为它建立索引就没有太大的实际效果。</li>
</ul>
<h4 id="4-3-索引失效的场景"><a href="#4-3-索引失效的场景" class="headerlink" title="4.3 索引失效的场景"></a>4.3 索引失效的场景</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `<span class="keyword">user</span>` (</span><br><span class="line">  `id` <span class="type">int</span> unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ID&#x27;</span>,</span><br><span class="line">  `id_no` <span class="type">varchar</span>(<span class="number">18</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;身份编号&#x27;</span>,</span><br><span class="line">  `username` <span class="type">varchar</span>(<span class="number">32</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;用户名&#x27;</span>,</span><br><span class="line">  `age` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;年龄&#x27;</span>,</span><br><span class="line">  `create_time` datetime <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  KEY `union_idx` (`id_no`,`username`,`age`),</span><br><span class="line">  KEY `create_time_idx` (`create_time`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_bin;</span><br></pre></td></tr></table></figure>


<h5 id="4-3-1-联合索引不满足最左匹配原则"><a href="#4-3-1-联合索引不满足最左匹配原则" class="headerlink" title="4.3.1 联合索引不满足最左匹配原则"></a>4.3.1 联合索引不满足最左匹配原则</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id_no <span class="operator">=</span> <span class="string">&#x27;1000001&#x27;</span>;</span><br><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id_no <span class="operator">=</span> <span class="string">&#x27;1000001&#x27;</span> <span class="keyword">and</span> username <span class="operator">=</span> <span class="string">&#x27;张1&#x27;</span></span><br><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id_no <span class="operator">=</span> <span class="string">&#x27;1000001&#x27;</span> <span class="keyword">and</span> age <span class="operator">=</span> <span class="number">63</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 失效查询</span></span><br><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username <span class="operator">=</span> <span class="string">&#x27;张1&#x27;</span> <span class="keyword">and</span> age <span class="operator">=</span> <span class="number">63</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="4-3-2-使用了select-，从而没有走覆盖索引"><a href="#4-3-2-使用了select-，从而没有走覆盖索引" class="headerlink" title="4.3.2 使用了select * ，从而没有走覆盖索引"></a>4.3.2 使用了select * ，从而没有走覆盖索引</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 注意Extra</span></span><br><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id_no <span class="operator">=</span> <span class="string">&#x27;1000001&#x27;</span> <span class="keyword">and</span> username <span class="operator">=</span> <span class="string">&#x27;张1&#x27;</span>;</span><br><span class="line">explain <span class="keyword">select</span> id_no, username, age <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id_no <span class="operator">=</span> <span class="string">&#x27;1000001&#x27;</span> <span class="keyword">and</span> username <span class="operator">=</span> <span class="string">&#x27;张1&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="4-3-3-索引列参与计算"><a href="#4-3-3-索引列参与计算" class="headerlink" title="4.3.3 索引列参与计算"></a>4.3.3 索引列参与计算</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id <span class="operator">+</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">2</span> ;</span><br></pre></td></tr></table></figure>

<h5 id="4-3-4-索引列使用了函数"><a href="#4-3-4-索引列使用了函数" class="headerlink" title="4.3.4 索引列使用了函数"></a>4.3.4 索引列使用了函数</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> SUBSTR(id_no,<span class="number">1</span>) <span class="operator">=</span> <span class="string">&#x27;10000111&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h5 id="4-3-5-错误的Like使用"><a href="#4-3-5-错误的Like使用" class="headerlink" title="4.3.5 错误的Like使用"></a>4.3.5 错误的Like使用</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id_no <span class="keyword">like</span> <span class="string">&#x27;%10000111%&#x27;</span>;</span><br><span class="line"></span><br><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id_no <span class="keyword">like</span> <span class="string">&#x27;10000111%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h5 id="4-3-6-类型隐式转换"><a href="#4-3-6-类型隐式转换" class="headerlink" title="4.3.6 类型隐式转换"></a>4.3.6 类型隐式转换</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id_no <span class="operator">=</span> <span class="number">1000001</span>;</span><br></pre></td></tr></table></figure>

<h5 id="4-3-7-使用OR操作"><a href="#4-3-7-使用OR操作" class="headerlink" title="4.3.7 使用OR操作"></a>4.3.7 使用OR操作</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id_no <span class="operator">=</span> <span class="string">&#x27;1000001&#x27;</span> <span class="keyword">or</span> username <span class="operator">=</span> <span class="string">&#x27;张1&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h5 id="4-3-8-两列做比较"><a href="#4-3-8-两列做比较" class="headerlink" title="4.3.8 两列做比较"></a>4.3.8 两列做比较</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id <span class="operator">&lt;</span> age;</span><br></pre></td></tr></table></figure>

<h5 id="4-3-9-不等于比较"><a href="#4-3-9-不等于比较" class="headerlink" title="4.3.9 不等于比较"></a>4.3.9 不等于比较</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id_no <span class="operator">!=</span> <span class="string">&#x27;1000001&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 主键索引使用不等于也是走索引的</span></span><br><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id <span class="operator">!=</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h5 id="4-3-10-is-not-null作"><a href="#4-3-10-is-not-null作" class="headerlink" title="4.3.10 is not null作"></a>4.3.10 is not null作</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id_no <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>

<h5 id="4-3-11-not-in和not-exists"><a href="#4-3-11-not-in和not-exists" class="headerlink" title="4.3.11 not in和not exists"></a>4.3.11 not in和not exists</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id <span class="keyword">not</span> <span class="keyword">in</span> (<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id_no <span class="keyword">not</span> <span class="keyword">in</span> (<span class="string">&#x27;1000001&#x27;</span>,<span class="string">&#x27;1000009&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 正常情况</span></span><br><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id <span class="keyword">in</span> (<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">explain <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> id_no <span class="keyword">in</span> (<span class="string">&#x27;1000001&#x27;</span>,<span class="string">&#x27;1000009&#x27;</span>);</span><br></pre></td></tr></table></figure>


<h4 id="4-4-explain字段详细说明"><a href="#4-4-explain字段详细说明" class="headerlink" title="4.4 explain字段详细说明"></a>4.4 explain字段详细说明</h4><p><em><strong><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/348775529">参考</a></strong></em></p>
<img src="img/执行计划.png" align='left'/>

<h4 id="4-5-索引碎片"><a href="#4-5-索引碎片" class="headerlink" title="4.5 索引碎片"></a>4.5 索引碎片</h4><h5 id="4-5-1-前置说明"><a href="#4-5-1-前置说明" class="headerlink" title="4.5.1 前置说明"></a>4.5.1 前置说明</h5><ul>
<li>每一个页包含了一个指向上一个和下一个页的指针。页的逻辑顺序和物理顺序或许是不一致的。指向下一个页的指针后续会指向位于同一个区的页，或者指向几百个页之前的一个页（也可能是之后）。</li>
<li>页的物理顺序和逻辑顺序越一致，扫描整个索引所需要的IO数就越少。当两个顺序一致的时候，每次IO可读取一整个区或者更多。同样的，页的物理顺序和逻辑顺序越相关，那么使用的预读数便越多（预读：在使用之前，先将页存入内存）。不管是扫描整个索引，还是只扫描索引的一部分，这都是确定无疑的。</li>
<li>索引碎片的分类：<ul>
<li>一个页内空闲容量的百分比称为页的<code>内部碎片</code>；</li>
<li>逻辑顺序和物理顺序的偏差称为<code>外部碎片</code>；</li>
</ul>
</li>
</ul>
<h5 id="4-5-2-内部碎片简述"><a href="#4-5-2-内部碎片简述" class="headerlink" title="4.5.2 内部碎片简述"></a>4.5.2 内部碎片简述</h5><blockquote>
<p>覆盖率 &#x3D; 数据字节数 &#x2F; 一页字节数</p>
<p>内部碎片率  &#x3D;  1  -  覆盖率</p>
</blockquote>
<ul>
<li>内部碎片通常是以覆盖率的形式表现出来，并且其体现的是<strong>字节数</strong>上的覆盖率而不是条目上的覆盖率；</li>
<li>一个100%充满的是没有内部碎片的，但通常来说一个页是否被充满还与<strong>条目的大小</strong>相关，当一个覆盖率是96%的索引页而剩余的4%的页空间不够添加一个新的条目时，此时这个页是被完全充满的；</li>
</ul>
<h5 id="4-5-3-外部碎片简述"><a href="#4-5-3-外部碎片简述" class="headerlink" title="4.5.3 外部碎片简述"></a>4.5.3 外部碎片简述</h5><blockquote>
<p>外部碎片率 &#x3D; 索引叶子节点中的无序页数 &#x2F; 叶子节点总页数</p>
</blockquote>
<ul>
<li>无序页：当前页物理上分配的紧邻的页不是偏移指针所指向的页，那么当前页便称之为无序页；</li>
</ul>
<h5 id="4-5-4-碎片产生原因"><a href="#4-5-4-碎片产生原因" class="headerlink" title="4.5.4 碎片产生原因"></a>4.5.4 碎片产生原因</h5><blockquote>
<p>对于非聚簇索引来说无序的insert是外部碎片产生的主要因素，insert和delete是内部碎片产生的主要因素</p>
</blockquote>
<p><img src="/img/%E7%B4%A2%E5%BC%95%E7%A2%8E%E7%89%87%E7%9A%84%E4%BA%A7%E7%94%9F.png"></p>
<h5 id="4-5-5-碎片对性能的影响"><a href="#4-5-5-碎片对性能的影响" class="headerlink" title="4.5.5 碎片对性能的影响"></a>4.5.5 碎片对性能的影响</h5><blockquote>
<p>在官方文档的说明中，索引碎片率超过30%就会极大的影响性能，必须考虑重建索引</p>
</blockquote>
<ul>
<li>内部碎片的影响：<ul>
<li>内部碎片会<code>增加IO操作</code>。当执行的查询扫描部分或全部的表&#x2F;索引时，如果那个表&#x2F;索引上面有内部碎片，它会增加额外的页读取；</li>
<li>内部碎片<code>降低缓存效率</code>。当索引有碎片时，在缓存里就会占用更多的空间。这会降低缓存命中率，依次增加物理IO，同样增加逻辑读；</li>
<li>增加数据库文件。需要更多的空间来存储额外页，并降低备份和还原性能；</li>
</ul>
</li>
<li>外部碎片的影响：<ul>
<li>读取<code>单条记录</code>时，外部碎片不会影响性能，因为是直接到页里拿记录；</li>
<li>在<code>有序的索引扫描</code>里，外部碎片会成为性能下降因素。性能下降的原因是磁盘的磁头需要物理磁盘上来回跳；</li>
</ul>
</li>
</ul>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2023/04/13/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/mysql%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">mysql数据结构</a></p>
        <p><span>文章作者:</span><a href="/" title="回到主页">王霄</a></p>
        <p><span>发布时间:</span>2023-04-13, 00:00:00</p>
        <p><span>最后更新:</span>2023-05-14, 09:43:34</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2023/04/13/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/mysql%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="mysql数据结构">http://example.com/2023/04/13/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/mysql%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/</a>
            <span class="copy-path" data-clipboard-text="原文: http://example.com/2023/04/13/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/mysql%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/　　作者: 王霄" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



    <nav id="article-nav">
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2023/02/17/%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/Mqtt%E9%9D%A2%E8%AF%95%E9%A2%98/">
                    Mqtt面试题
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">文章目录</strong>
        
            <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-mysql%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.</span> <span class="toc-text">1. mysql数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-mysql%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">2.</span> <span class="toc-text">2. mysql数据结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E8%A1%A8%E7%A9%BA%E9%97%B4%EF%BC%88tablespace%EF%BC%89"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 表空间（tablespace）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-1-%E7%B3%BB%E7%BB%9F%E8%A1%A8%E7%A9%BA%E9%97%B4%EF%BC%88System-Tablespace%EF%BC%89"><span class="toc-number">2.1.1.</span> <span class="toc-text">2.1.1 系统表空间（System Tablespace）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-2-%E8%A1%A8%E6%96%87%E4%BB%B6%E8%A1%A8%E7%A9%BA%E9%97%B4%EF%BC%88File-Per-Table-Tablespaces%EF%BC%89"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.1.2 表文件表空间（File-Per-Table Tablespaces）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-3-%E9%80%9A%E7%94%A8%E8%A1%A8%E7%A9%BA%E9%97%B4%EF%BC%88General-Tablespaces%EF%BC%89"><span class="toc-number">2.1.3.</span> <span class="toc-text">2.1.3 通用表空间（General Tablespaces）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-4-undo%E8%A1%A8%E7%A9%BA%E9%97%B4%EF%BC%88undo-tablespace%EF%BC%89"><span class="toc-number">2.1.4.</span> <span class="toc-text">2.1.4 undo表空间（undo tablespace）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-5-%E4%B8%B4%E6%97%B6%E8%A1%A8%E7%A9%BA%E9%97%B4%EF%BC%88Temporary-Tablespace%EF%BC%89"><span class="toc-number">2.1.5.</span> <span class="toc-text">2.1.5 临时表空间（Temporary Tablespace）</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E9%A1%B5%EF%BC%88page%EF%BC%89"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 页（page）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-1-%E9%A1%B5%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.2.1.</span> <span class="toc-text">2.2.1 页的介绍</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-2-%E9%A1%B5%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.2.2 页的数据结构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-3-%E9%A1%B5%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.2.3.</span> <span class="toc-text">2.2.3 页的类型</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E5%8C%BA%EF%BC%88extent%EF%BC%89"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 区（extent）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-%E6%AE%B5%EF%BC%88segment%EF%BC%89"><span class="toc-number">2.4.</span> <span class="toc-text">2.4 段（segment）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BC%95%E6%93%8E"><span class="toc-number">3.</span> <span class="toc-text">3. 数据库引擎</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-%E5%BC%95%E6%93%8E%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 引擎是什么？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-%E5%B8%B8%E7%94%A8%E7%9A%84%E5%BC%95%E6%93%8E"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 常用的引擎</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-1-InnoDB"><span class="toc-number">3.2.1.</span> <span class="toc-text">3.2.1 InnoDB</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-2-MyISAM"><span class="toc-number">3.2.2.</span> <span class="toc-text">3.2.2 MyISAM</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-3-Archive"><span class="toc-number">3.2.3.</span> <span class="toc-text">3.2.3 Archive</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-4-Blackhole"><span class="toc-number">3.2.4.</span> <span class="toc-text">3.2.4 Blackhole</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-5-CSV"><span class="toc-number">3.2.5.</span> <span class="toc-text">3.2.5 CSV</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-6-Federated"><span class="toc-number">3.2.6.</span> <span class="toc-text">3.2.6 Federated</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-7-Memroy"><span class="toc-number">3.2.7.</span> <span class="toc-text">3.2.7 Memroy</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-8-Merge"><span class="toc-number">3.2.8.</span> <span class="toc-text">3.2.8 Merge</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-9-NDB"><span class="toc-number">3.2.9.</span> <span class="toc-text">3.2.9 NDB</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B4%A2%E5%BC%95"><span class="toc-number">4.</span> <span class="toc-text">4. 数据库索引</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-%E7%B4%A2%E5%BC%95%E5%88%86%E7%B1%BB"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 索引分类</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#4-1-1-%E6%8C%89%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%88%86%E7%B1%BB"><span class="toc-number">4.1.1.</span> <span class="toc-text">4.1.1 按数据结构分类</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#4-1-1-1-B-tree%E7%B4%A2%E5%BC%95"><span class="toc-number">4.1.1.1.</span> <span class="toc-text">4.1.1.1 B+tree索引</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-1-1-2-Hash%E7%B4%A2%E5%BC%95"><span class="toc-number">4.1.1.2.</span> <span class="toc-text">4.1.1.2 Hash索引</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-1-1-3-Full-text%E7%B4%A2%E5%BC%95"><span class="toc-number">4.1.1.3.</span> <span class="toc-text">4.1.1.3 Full-text索引</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-1-2-%E6%8C%89%E7%89%A9%E7%90%86%E5%AD%98%E5%82%A8%E5%88%86%E7%B1%BB"><span class="toc-number">4.1.2.</span> <span class="toc-text">4.1.2 按物理存储分类</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#4-1-2-1-%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95"><span class="toc-number">4.1.2.1.</span> <span class="toc-text">4.1.2.1 聚簇索引</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-1-2-2-%E9%9D%9E%E8%81%9A%E9%9B%86%E7%B4%A2%E5%BC%95"><span class="toc-number">4.1.2.2.</span> <span class="toc-text">4.1.2.2 非聚集索引</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-1-2-3-%E4%BA%8C%E7%BA%A7%E7%B4%A2%E5%BC%95-%E8%A6%86%E7%9B%96%E7%B4%A2%E5%BC%95"><span class="toc-number">4.1.2.3.</span> <span class="toc-text">4.1.2.3 二级索引(覆盖索引)</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-1-3-%E6%8C%89%E7%89%A9%E7%90%86%E5%AD%98%E5%82%A8%E5%88%86%E7%B1%BB"><span class="toc-number">4.1.3.</span> <span class="toc-text">4.1.3 按物理存储分类</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#4-1-3-1-%E4%B8%BB%E9%94%AE%E7%B4%A2%E5%BC%95-PRIMARY-KEY"><span class="toc-number">4.1.3.1.</span> <span class="toc-text">4.1.3.1 主键索引(PRIMARY KEY)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-1-3-2-%E5%94%AF%E4%B8%80%E7%B4%A2%E5%BC%95-UNIQUE"><span class="toc-number">4.1.3.2.</span> <span class="toc-text">4.1.3.2 唯一索引(UNIQUE)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-1-3-3-%E6%99%AE%E9%80%9A%E7%B4%A2%E5%BC%95-INDEX"><span class="toc-number">4.1.3.3.</span> <span class="toc-text">4.1.3.3 普通索引(INDEX)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-1-3-4-%E5%85%A8%E6%96%87%E7%B4%A2%E5%BC%95-FULLTEXT"><span class="toc-number">4.1.3.4.</span> <span class="toc-text">4.1.3.4 全文索引(FULLTEXT)</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-1-4-%E6%8C%89%E5%AD%97%E6%AE%B5%E4%B8%AA%E6%95%B0%E5%88%86%E7%B1%BB"><span class="toc-number">4.1.4.</span> <span class="toc-text">4.1.4 按字段个数分类</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#4-1-4-1-%E5%8D%95%E5%88%97%E7%B4%A2%E5%BC%95"><span class="toc-number">4.1.4.1.</span> <span class="toc-text">4.1.4.1 单列索引</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#4-1-4-2-%E8%81%94%E5%90%88%E7%B4%A2%E5%BC%95"><span class="toc-number">4.1.4.2.</span> <span class="toc-text">4.1.4.2 联合索引</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-%E5%93%AA%E4%BA%9B%E6%83%85%E5%86%B5%E9%9C%80%E8%A6%81%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95"><span class="toc-number">4.2.</span> <span class="toc-text">4.2 哪些情况需要创建索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-%E5%93%AA%E4%BA%9B%E6%83%85%E5%86%B5%E4%B8%8D%E9%9C%80%E8%A6%81%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95"><span class="toc-number">4.3.</span> <span class="toc-text">4.3 哪些情况不需要创建索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%E7%9A%84%E5%9C%BA%E6%99%AF"><span class="toc-number">4.4.</span> <span class="toc-text">4.3 索引失效的场景</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#4-3-1-%E8%81%94%E5%90%88%E7%B4%A2%E5%BC%95%E4%B8%8D%E6%BB%A1%E8%B6%B3%E6%9C%80%E5%B7%A6%E5%8C%B9%E9%85%8D%E5%8E%9F%E5%88%99"><span class="toc-number">4.4.1.</span> <span class="toc-text">4.3.1 联合索引不满足最左匹配原则</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-3-2-%E4%BD%BF%E7%94%A8%E4%BA%86select-%EF%BC%8C%E4%BB%8E%E8%80%8C%E6%B2%A1%E6%9C%89%E8%B5%B0%E8%A6%86%E7%9B%96%E7%B4%A2%E5%BC%95"><span class="toc-number">4.4.2.</span> <span class="toc-text">4.3.2 使用了select * ，从而没有走覆盖索引</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-3-3-%E7%B4%A2%E5%BC%95%E5%88%97%E5%8F%82%E4%B8%8E%E8%AE%A1%E7%AE%97"><span class="toc-number">4.4.3.</span> <span class="toc-text">4.3.3 索引列参与计算</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-3-4-%E7%B4%A2%E5%BC%95%E5%88%97%E4%BD%BF%E7%94%A8%E4%BA%86%E5%87%BD%E6%95%B0"><span class="toc-number">4.4.4.</span> <span class="toc-text">4.3.4 索引列使用了函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-3-5-%E9%94%99%E8%AF%AF%E7%9A%84Like%E4%BD%BF%E7%94%A8"><span class="toc-number">4.4.5.</span> <span class="toc-text">4.3.5 错误的Like使用</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-3-6-%E7%B1%BB%E5%9E%8B%E9%9A%90%E5%BC%8F%E8%BD%AC%E6%8D%A2"><span class="toc-number">4.4.6.</span> <span class="toc-text">4.3.6 类型隐式转换</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-3-7-%E4%BD%BF%E7%94%A8OR%E6%93%8D%E4%BD%9C"><span class="toc-number">4.4.7.</span> <span class="toc-text">4.3.7 使用OR操作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-3-8-%E4%B8%A4%E5%88%97%E5%81%9A%E6%AF%94%E8%BE%83"><span class="toc-number">4.4.8.</span> <span class="toc-text">4.3.8 两列做比较</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-3-9-%E4%B8%8D%E7%AD%89%E4%BA%8E%E6%AF%94%E8%BE%83"><span class="toc-number">4.4.9.</span> <span class="toc-text">4.3.9 不等于比较</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-3-10-is-not-null%E4%BD%9C"><span class="toc-number">4.4.10.</span> <span class="toc-text">4.3.10 is not null作</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-3-11-not-in%E5%92%8Cnot-exists"><span class="toc-number">4.4.11.</span> <span class="toc-text">4.3.11 not in和not exists</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-explain%E5%AD%97%E6%AE%B5%E8%AF%A6%E7%BB%86%E8%AF%B4%E6%98%8E"><span class="toc-number">4.5.</span> <span class="toc-text">4.4 explain字段详细说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-%E7%B4%A2%E5%BC%95%E7%A2%8E%E7%89%87"><span class="toc-number">4.6.</span> <span class="toc-text">4.5 索引碎片</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#4-5-1-%E5%89%8D%E7%BD%AE%E8%AF%B4%E6%98%8E"><span class="toc-number">4.6.1.</span> <span class="toc-text">4.5.1 前置说明</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-5-2-%E5%86%85%E9%83%A8%E7%A2%8E%E7%89%87%E7%AE%80%E8%BF%B0"><span class="toc-number">4.6.2.</span> <span class="toc-text">4.5.2 内部碎片简述</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-5-3-%E5%A4%96%E9%83%A8%E7%A2%8E%E7%89%87%E7%AE%80%E8%BF%B0"><span class="toc-number">4.6.3.</span> <span class="toc-text">4.5.3 外部碎片简述</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-5-4-%E7%A2%8E%E7%89%87%E4%BA%A7%E7%94%9F%E5%8E%9F%E5%9B%A0"><span class="toc-number">4.6.4.</span> <span class="toc-text">4.5.4 碎片产生原因</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-5-5-%E7%A2%8E%E7%89%87%E5%AF%B9%E6%80%A7%E8%83%BD%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="toc-number">4.6.5.</span> <span class="toc-text">4.5.5 碎片对性能的影响</span></a></li></ol></li></ol></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

    <script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"false"];
    </script>





    



<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/love.js"></script>



    <div class="scroll" id="post-nav-button">
        
            <a href="/" title="回到主页"><i class="fa fa-home"></i></a>
        

        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2023/02/17/%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/Mqtt%E9%9D%A2%E8%AF%95%E9%A2%98/" title="下一篇: Mqtt面试题">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2023/04/13/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/mysql%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">mysql数据结构</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/02/17/%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/Mqtt%E9%9D%A2%E8%AF%95%E9%A2%98/">Mqtt面试题</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/02/17/%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/Spring%E4%BA%8B%E5%8A%A1%E7%9A%84%E4%BC%A0%E6%92%AD%E6%9C%BA%E5%88%B6/">Spring事务的传播机制</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/02/17/%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E6%9C%BA%E5%88%B6/">事务的隔离机制</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/02/17/%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/%E7%B4%A2%E5%BC%95/">索引</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/02/17/%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/%E9%99%90%E6%B5%81-%E7%86%94%E6%96%AD-%E6%9C%8D%E5%8A%A1%E9%99%8D%E7%BA%A7/">限流-熔断-服务降级</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/06/15/%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/%E6%8E%A5%E5%8F%A3%E5%B9%82%E7%AD%89%E6%80%A7/">接口幂等性</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/22/%E5%BE%AE%E6%9C%8D%E5%8A%A1/sentinel/">sentinel</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/09/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/git/gitlab%E5%AE%89%E8%A3%85/">gitlab安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/08/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/rabbitmq/rabbitmq%E5%AD%A6%E4%B9%A0/">rabbitmq学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/08/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/rabbitmq/rabbitmq%E5%AE%89%E8%A3%85/">rabbitmq安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/06/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/zookeeper%E5%AE%89%E8%A3%85/">zookeeper安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1/nacos/">nacos安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/%E5%BE%AE%E6%9C%8D%E5%8A%A1/springcloud/">springcloud学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/01/java/java%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B/">java引用类型</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/01/java/jdk%E5%AE%89%E8%A3%85/">jdk安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/01/%E5%85%B6%E4%BB%96/jmeter%E5%AD%A6%E4%B9%A0/">jmeter学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/01/java/%E5%A4%9A%E7%BA%BF%E7%A8%8B/java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/">java并发编程</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/01/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/git/git%E5%91%BD%E4%BB%A4%E5%A4%A7%E5%85%A8/">git命令大全</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/01/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/git/git%E5%AE%89%E8%A3%85/">git安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/15/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/%E7%BA%BF%E4%B8%8Aoom%E9%97%AE%E9%A2%98/">线上oom问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/11/linux/linux%E5%AD%A6%E4%B9%A0/">Linux学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/11/linux/linux%E6%94%B6%E8%97%8F%E6%8C%87%E4%BB%A4/">Linux收藏指令</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/08/java/java8/lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F/">lambda表达式</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/07/%E9%A1%B9%E7%9B%AE%E5%BA%94%E7%94%A8/%E5%BB%B6%E6%97%B6%E8%AE%A2%E5%8D%95%E5%A4%84%E7%90%86/">延时订单处理</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/07/java/springboot/springboot%E6%95%B4%E5%90%88mongodb/">springboot整合mongodb</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/06/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/%E5%AE%9A%E6%97%B6%E5%99%A8%E4%B8%8D%E6%89%A7%E8%A1%8C%E9%97%AE%E9%A2%98/">定时器不执行问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/06/%E9%A1%B9%E7%9B%AE%E6%80%BB%E7%BB%93/%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/">索引失效问题排查</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/08/06/java/springboot/springboot%E6%95%B4%E5%90%88redis/">springboot整合redis</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/10/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%AF%B9%E6%AF%94%E5%92%8C%E9%80%89%E5%9E%8B/">消息中间件对比和选型</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/10/java/springboot/springboot%E6%95%B4%E5%90%88activemq/">springboot整合activemq</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/10/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/activemq/activemq%E5%AD%A6%E4%B9%A0/">activemq学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/10/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/activemq/activemq%E5%AE%89%E8%A3%85/">activemq安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/09/java/springboot/springboot%E6%95%B4%E5%90%88kafka/">springboot整合kafka</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/09/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/kafka/kafka%E5%AD%A6%E4%B9%A0/">kafka学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/09/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/kafka/kafka%E5%AE%89%E8%A3%85/">kafka安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/08/java/springboot/springboot%E6%95%B4%E5%90%88rabbitmq/">springboot整合rabbitmq</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/07/java/springboot/springboot%E6%95%B4%E5%90%88rocketmq/">springboot整合rocketmq</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/07/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/rocketmq/rocketmq%E5%AD%A6%E4%B9%A0/">rocketmq学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/07/%E6%B6%88%E6%81%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/rocketmq/rocketmq%E5%AE%89%E8%A3%85/">rocketmq安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/25/%E9%A1%B9%E7%9B%AE%E5%BA%94%E7%94%A8/%E6%8E%A5%E5%8F%A3%E9%99%90%E6%B5%81/">接口限流</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/25/java/springboot/springboot%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F/">springboot项目部署的两种方式</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/08/06/%E6%95%B0%E6%8D%AE%E5%BA%93/mongodb/mongodb%E5%AD%A6%E4%B9%A0/">mongodb学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/08/06/%E6%95%B0%E6%8D%AE%E5%BA%93/mongodb/mongodb%E5%AE%89%E8%A3%85/">mongodb安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/08/06/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/mysql%E5%AD%A6%E4%B9%A0/">mysql学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/08/06/%E6%95%B0%E6%8D%AE%E5%BA%93/redis/redis%E5%AD%A6%E4%B9%A0/">redis学习</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/08/06/%E6%95%B0%E6%8D%AE%E5%BA%93/redis/redis%E5%AE%89%E8%A3%85/">redis安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/05/%E7%AE%97%E6%B3%95/%E6%8E%92%E5%BA%8F/%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F/">冒泡排序</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/05/%E7%AE%97%E6%B3%95/%E6%8E%92%E5%BA%8F/%E9%80%89%E6%8B%A9%E6%8E%92%E5%BA%8F/">选择排序</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/01/%E7%AE%97%E6%B3%95/%E5%8D%81%E8%BF%9B%E5%88%B6%E8%BD%AC%E6%8D%A2%E4%B8%BA%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%AE%97%E6%B3%95/">十进制数字转换为二进制</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/12/19/%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4/docker/docker%E5%85%A5%E9%97%A8/">Docker简介</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/23/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/">设计模式之适配器模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/22/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/">设计模式之建造者模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/21/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/">设计模式之原型模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/20/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/">设计模式之工厂方法模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/19/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/">设计模式之简单工厂模式</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/18/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/">设计模式之单例模式</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2018-2023 王霄
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="本站到访数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="本页阅读量"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
    
<script src="/js/GithubRepoWidget.js"></script>


<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>





    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        $("a[target=_blank]").removeAttr("target");
    
</script>

    <script>
        var originTitle = document.title;
        var titleTime;
        document.addEventListener("visibilitychange", function() {
            if (document.hidden) {
                document.title = "开心" + originTitle;
                clearTimeout(titleTime);
            }
            else {
                document.title = "不开心" + originTitle;
                titleTime = setTimeout(function() {
                    document.title = originTitle;
                }, 2000);
            }
        })
    </script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>